<!DOCTYPE html> <meta charset=utf-8  /> <meta name=viewport  content="width=device-width, initial-scale=1.0" /><meta name=generator  content="Docutils 0.17.1: http://docutils.sourceforge.net/" /> <meta name=viewport  content="width=device-width,initial-scale=1"> <meta http-equiv=x-ua-compatible  content="ie=edge"> <meta name="lang:clipboard.copy" content="Copy to clipboard"> <meta name="lang:clipboard.copied" content="Copied to clipboard"> <meta name="lang:search.language" content=en > <meta name="lang:search.pipeline.stopwords" content=True > <meta name="lang:search.pipeline.trimmer" content=True > <meta name="lang:search.result.none" content="No matching documents"> <meta name="lang:search.result.one" content="1 matching document"> <meta name="lang:search.result.other" content="# matching documents"> <meta name="lang:search.tokenizer" content="[\s\-]+"> <link href="https://fonts.gstatic.com/" rel=preconnect  crossorigin> <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel=stylesheet > <style> body, input { font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif } code, kbd, pre { font-family: "Roboto Mono", "Courier New", Courier, monospace } </style> <link rel=stylesheet  href="../../_static/stylesheets/application.css"/> <link rel=stylesheet  href="../../_static/stylesheets/application-palette.css"/> <link rel=stylesheet  href="../../_static/stylesheets/application-fixes.css"/> <link rel=stylesheet  href="../../_static/fonts/material-icons.css"/> <meta name=theme-color  content="#2196f3"> <script src="../../_static/javascripts/modernizr.js"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-XX133829453-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'UA-XX133829453-1'); </script> <title>Matrices as Images &#8212; Practical Data Science</title> <link rel=stylesheet  type="text/css" href="../../_static/pygments.css" /> <link rel=stylesheet  type="text/css" href="../../_static/material.css" /> <script data-url_root="../../" id=documentation_options  src="../../_static/documentation_options.js"></script> <script src="../../_static/jquery.js"></script> <script src="../../_static/underscore.js"></script> <script src="../../_static/doctools.js"></script> <script crossorigin=anonymous  integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script> <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script> <script defer=defer  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <link rel="shortcut icon" href="../../_static/mids_logo.svg"/> <link rel=index  title=Index  href="../../genindex.html" /> <link rel=search  title=Search  href="../../search.html" /> <body dir=ltr data-md-color-primary=blue-grey data-md-color-accent=blue> <svg class=md-svg > <defs data-children-count=0 > <svg xmlns="http://www.w3.org/2000/svg" width=416  height=448  viewBox="0 0 416 448" id=__github ><path fill=currentColor  d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle  data-md-toggle=drawer  type=checkbox  id=__drawer > <input class=md-toggle  data-md-toggle=search  type=checkbox  id=__search > <label class=md-overlay  data-md-component=overlay  for=__drawer ></label> <a href="#30_numpy/20_matrices/25_images_as_matrices" tabindex=1  class=md-skip > Skip to content </a> <header class=md-header  data-md-component=header > <nav class="md-header-nav md-grid"> <div class="md-flex navheader"> <div class="md-flex__cell md-flex__cell--shrink"> <a href="../../index.html" title="Practical Data Science" class="md-header-nav__button md-logo"> <img src="../../_static/mids_logo.svg" height=26  alt="Practical Data Science logo"> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer ></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title > <span class=md-header-nav__topic >Practical Data Science</span> <span class=md-header-nav__topic > Matrices as Images </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search ></label> <div class=md-search  data-md-component=search  role=dialog > <label class=md-search__overlay  for=__search ></label> <div class=md-search__inner  role=search > <form class=md-search__form  action="../../search.html" method=get  name=search > <input type=text  class=md-search__input  name=q  placeholder=""Search"" autocapitalize=off  autocomplete=off  spellcheck=false  data-md-component=query  data-md-state=active > <label class="md-icon md-search__icon" for=__search ></label> <button type=reset  class="md-icon md-search__icon" data-md-component=reset  tabindex=-1 > &#xE5CD; </button> </form> <div class=md-search__output > <div class=md-search__scrollwrap  data-md-scrollfix> <div class=md-search-result  data-md-component=result > <div class=md-search-result__meta > Type to start searching </div> <ol class=md-search-result__list ></ol> </div> </div> </div> </div> </div> </div> <script src="../../_static/javascripts/version_dropdown.js"></script> <script> var json_loc = "../../"versions.json"", target_loc = "../../../", text = "Versions"; $( document ).ready( add_version_dropdown(json_loc, target_loc, text)); </script> </div> </nav> </header> <div class=md-container > <nav class=md-tabs  data-md-component=tabs > <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list > <li class=md-tabs__item ><a href="../../index.html" class=md-tabs__link >Home</a> <li class=md-tabs__item ><a href="../../class_schedule.html" class=md-tabs__link >Class Schedule</a> <li class=md-tabs__item ><a href="../../topic_list.html" class=md-tabs__link >Topic List</a> <li class=md-tabs__item ><a href="https://www.nickeubank.com" class=md-tabs__link >About The Author</a> </ul> </div> </nav> <main class=md-main > <div class="md-main__inner md-grid" data-md-component=container > <div class="md-sidebar md-sidebar--primary" data-md-component=navigation > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--primary" data-md-level=0 > <label class="md-nav__title md-nav__title--site" for=__drawer > <a href="../../index.html" title="Practical Data Science" class="md-nav__button md-logo"> <img src="../../_static/mids_logo.svg" alt=" logo" width=48  height=48 > </a> <a href="../../index.html" title="Practical Data Science">Practical Data Science</a> </label> <ul class=md-nav__list > <li class=md-nav__item > <a href="../../class_schedule.html" class=md-nav__link >Class Schedule</a> <li class=md-nav__item > <a href="../../autograder_guidelines.html" class=md-nav__link >Autograder Guidelines</a> <li class=md-nav__item > <a href="../../not_a_mids_student.html" class=md-nav__link >Not a MIDS Student?</a> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--secondary"> <label class=md-nav__title  for=__toc >"Contents"</label> <ul class=md-nav__list  data-md-scrollfix=""> <li class=md-nav__item ><a href="#30-numpy-20-matrices-25-images-as-matrices--page-root" class=md-nav__link >Matrices as Images</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Image-Manipulation" class=md-nav__link >Image Manipulation</a> <li class=md-nav__item ><a href="#Adjusting-Contrast" class=md-nav__link >Adjusting Contrast</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Generalizing-Contrast-Adjustment" class=md-nav__link >Generalizing Contrast Adjustment</a> </ul> </nav> <li class=md-nav__item ><a href="#Color-Images" class=md-nav__link >Color Images</a> </ul> </nav> </ul> </nav> </div> </div> </div> <div class=md-content > <article class="md-content__inner md-typeset" role=main > <style> /* CSS for nbsphinx extension */ /* remove conflicting styling from Sphinx themes */ div.nbinput.container div.prompt *, div.nboutput.container div.prompt *, div.nbinput.container div.input_area pre, div.nboutput.container div.output_area pre, div.nbinput.container div.input_area .highlight, div.nboutput.container div.output_area .highlight { border: none; padding: 0; margin: 0; box-shadow: none; } div.nbinput.container > div[class*=highlight], div.nboutput.container > div[class*=highlight] { margin: 0; } div.nbinput.container div.prompt *, div.nboutput.container div.prompt * { background: none; } div.nboutput.container div.output_area .highlight, div.nboutput.container div.output_area pre { background: unset; } div.nboutput.container div.output_area div.highlight { color: unset; /* override Pygments text color */ } /* avoid gaps between output lines */ div.nboutput.container div[class*=highlight] pre { line-height: normal; } /* input/output containers */ div.nbinput.container, div.nboutput.container { display: -webkit-flex; display: flex; align-items: flex-start; margin: 0; width: 100%; } @media (max-width: 540px) { div.nbinput.container, div.nboutput.container { flex-direction: column; } } /* input container */ div.nbinput.container { padding-top: 5px; } /* last container */ div.nblast.container { padding-bottom: 5px; } /* input prompt */ div.nbinput.container div.prompt pre { color: #307FC1; } /* output prompt */ div.nboutput.container div.prompt pre { color: #BF5B3D; } /* all prompts */ div.nbinput.container div.prompt, div.nboutput.container div.prompt { width: 4.5ex; padding-top: 5px; position: relative; user-select: none; } div.nbinput.container div.prompt > div, div.nboutput.container div.prompt > div { position: absolute; right: 0; margin-right: 0.3ex; } @media (max-width: 540px) { div.nbinput.container div.prompt, div.nboutput.container div.prompt { width: unset; text-align: left; padding: 0.4em; } div.nboutput.container div.prompt.empty { padding: 0; } div.nbinput.container div.prompt > div, div.nboutput.container div.prompt > div { position: unset; } } /* disable scrollbars on prompts */ div.nbinput.container div.prompt pre, div.nboutput.container div.prompt pre { overflow: hidden; } /* input/output area */ div.nbinput.container div.input_area, div.nboutput.container div.output_area { -webkit-flex: 1; flex: 1; overflow: auto; } @media (max-width: 540px) { div.nbinput.container div.input_area, div.nboutput.container div.output_area { width: 100%; } } /* input area */ div.nbinput.container div.input_area { border: 1px solid #e0e0e0; border-radius: 2px; /*background: #f5f5f5;*/ } /* override MathJax center alignment in output cells */ div.nboutput.container div[class*=MathJax] { text-align: left !important; } /* override sphinx.ext.imgmath center alignment in output cells */ div.nboutput.container div.math p { text-align: left; } /* standard error */ div.nboutput.container div.output_area.stderr { background: #fdd; } /* ANSI colors */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } div.nbinput.container div.input_area div[class*=highlight] > pre, div.nboutput.container div.output_area div[class*=highlight] > pre, div.nboutput.container div.output_area div[class*=highlight].math, div.nboutput.container div.output_area.rendered_html, div.nboutput.container div.output_area > div.output_javascript, div.nboutput.container div.output_area:not(.rendered_html) > img{ padding: 5px; margin: 0; } /* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */ div.nbinput.container div.input_area > div[class^='highlight'], div.nboutput.container div.output_area > div[class^='highlight']{ overflow-y: hidden; } /* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */ .prompt .copybtn { display: none; } /* Some additional styling taken form the Jupyter notebook CSS */ .jp-RenderedHTMLCommon table, div.rendered_html table { border: none; border-collapse: collapse; border-spacing: 0; color: black; font-size: 12px; table-layout: fixed; } .jp-RenderedHTMLCommon thead, div.rendered_html thead { border-bottom: 1px solid black; vertical-align: bottom; } .jp-RenderedHTMLCommon tr, .jp-RenderedHTMLCommon th, .jp-RenderedHTMLCommon td, div.rendered_html tr, div.rendered_html th, div.rendered_html td { text-align: right; vertical-align: middle; padding: 0.5em 0.5em; line-height: normal; white-space: normal; max-width: none; border: none; } .jp-RenderedHTMLCommon th, div.rendered_html th { font-weight: bold; } .jp-RenderedHTMLCommon tbody tr:nth-child(odd), div.rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .jp-RenderedHTMLCommon tbody tr:hover, div.rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } </style> <section id=Matrices-as-Images > <h1 id=30-numpy-20-matrices-25-images-as-matrices--page-root >Matrices as Images<a class=headerlink  href="#30-numpy-20-matrices-25-images-as-matrices--page-root" title="Permalink to this headline">¶</a></h1> <p>In our first reading on matrices, we said that one important reason data scientists have to know how to work with matrices is that, from the perspective of a computer, images are basically just matrices.</p> <p>Uh… what?</p> <p>Most of us are accustomed to thinking about digital images as a grid of pixels, where each pixel is a square that contains a single color. But as we have learned in our previous classes, everything in a computer is a number, including colors. So instead of thinking of an image as a grid of little boxes filled with colors, computers see an image as a grid of numbers where each number represents a color. And a grid of numbers is nothing but a matrix!</p> <p>To illustrate, let’s load a simple greyscale <code class="docutils literal notranslate"><span class=pre >.png</span></code> photo of some jellyfish from the Monterey Bay Aquarium in California and display it using the <code class="docutils literal notranslate"><span class=pre >imshow</span></code> function from the <code class="docutils literal notranslate"><span class=pre >matplotlib</span></code> <code class="docutils literal notranslate"><span class=pre >pyplot</span></code> library:</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[26]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=kn >from</span> <span class=nn >matplotlib</span> <span class=kn >import</span> <span class=n >image</span>
<span class=kn >import</span> <span class=nn >matplotlib.pyplot</span> <span class=k >as</span> <span class=nn >plt</span>
<span class=kn >import</span> <span class=nn >numpy</span> <span class=k >as</span> <span class=nn >np</span>

<span class=c1 ># load image as pixel array</span>
<span class=n >jellyfish</span> <span class=o >=</span> <span class=n >image</span><span class=o >.</span><span class=n >imread</span><span class=p >(</span><span class=s2 >"images/jellyfish.png"</span><span class=p >)</span>
<span class=n >plt</span><span class=o >.</span><span class=n >imshow</span><span class=p >(</span><span class=n >jellyfish</span><span class=p >,</span> <span class=n >cmap</span><span class=o >=</span><span class=s2 >"gray"</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[26]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
&lt;matplotlib.image.AxesImage at 0x137d27df0&gt;
</pre></div></div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <img alt="../../_images/30_numpy_20_matrices_25_images_as_matrices_2_1.png" src="../../_images/30_numpy_20_matrices_25_images_as_matrices_2_1.png"/> </div> </div> <p>(A small aside: The photo that we <em>actually</em> wanted to use for this reading was the logo of the <a class="reference external" href="https://en.wikipedia.org/wiki/Monty_Python">Monty Python</a> comedy group, but we couldn’t find a good photo that wasn’t copyrighted. Why? Because despite what you might naturally assume given the prevalence of snake images on Python websites, <a class="reference external" href="https://en.wikipedia.org/wiki/Python_(programming_language)#Design_philosophy_and_features">the Python programming language is actually named after the Monty Python comedy group, not the snake!</a> But we didn’t want to get sued, so you will have to settle for a photo of jellyfish I took on vacation. :) )</p> <p>OK, so we can display this image, but what does that have to do with numpy? The answer is that this entire image is being represented by a 2000 x 1334 numpy matrix where each entry of the matrix contains a single value between 0 and 1 corresponding to how dark (values close to 0) or light (values close to 1) the corresponding pixel should be drawn:</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[27]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=nb >type</span><span class=p >(</span><span class=n >jellyfish</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[27]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
numpy.ndarray
</pre></div></div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[28]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >jellyfish</span><span class=o >.</span><span class=n >shape</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[28]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
(2000, 1334)
</pre></div></div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[29]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >jellyfish</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[29]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
array([[0.7474784 , 0.7514458 , 0.75539786, ..., 0.7237659 , 0.7198138 ,
        0.7237659 ],
       [0.7474784 , 0.771252  , 0.7593652 , ..., 0.70405126, 0.727718  ,
        0.7435111 ],
       [0.727718  , 0.73562217, 0.7514458 , ..., 0.70405126, 0.7198138 ,
        0.739559  ],
       ...,
       [0.14572366, 0.14229038, 0.1388571 , ..., 0.10151827, 0.10823224,
        0.11158923],
       [0.13543908, 0.13543908, 0.1388571 , ..., 0.11158923, 0.11158923,
        0.11496147],
       [0.1388571 , 0.14229038, 0.1388571 , ..., 0.11496147, 0.10823224,
        0.11158923]], dtype=float32)
</pre></div></div> </div> <section id=Image-Manipulation > <h2 id=Image-Manipulation >Image Manipulation<a class=headerlink  href="#Image-Manipulation" title="Permalink to this headline">¶</a></h2> <p>Because this is just a numpy array, we can manipulate it with basic numpy tools! For example, to make everything darker, we can just make all the numbers smaller by multiplying by 0.25:</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[34]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >darker</span> <span class=o >=</span> <span class=n >jellyfish</span> <span class=o >*</span> <span class=mf >0.75</span>
<span class=n >plt</span><span class=o >.</span><span class=n >imshow</span><span class=p >(</span><span class=n >darker</span><span class=p >,</span> <span class=n >cmap</span><span class=o >=</span><span class=s2 >"gray"</span><span class=p >,</span> <span class=n >vmin</span><span class=o >=</span><span class=mi >0</span><span class=p >,</span> <span class=n >vmax</span><span class=o >=</span><span class=mi >1</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[34]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
&lt;matplotlib.image.AxesImage at 0x137ee0af0&gt;
</pre></div></div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <img alt="../../_images/30_numpy_20_matrices_25_images_as_matrices_8_1.png" src="../../_images/30_numpy_20_matrices_25_images_as_matrices_8_1.png"/> </div> </div> <p>Note that we had to add the keyword arguments <code class="docutils literal notranslate"><span class=pre >vmin=0</span></code> and <code class="docutils literal notranslate"><span class=pre >vmax=1</span></code> to make this work;by default, <code class="docutils literal notranslate"><span class=pre >imshow</span></code> treats the maximum value in matrix as perfect white and the minimum value as perfect black, so without telling it that we want a value of 1 to correspond to perfect white, it would have just treated the new maximum value and the array <code class="docutils literal notranslate"><span class=pre >darker</span></code> (<code class="docutils literal notranslate"><span class=pre >0.75</span></code>) as perfect white, and the way the image looked would not have changed.</p> <p>We can also do more complicated manipulations. Suppose we wanted to increase the contrast of the image. How might we accomplish that?</p> <p>Well, if we only wanted values that were perfectly black or white (i.e. we wanted a two-tone image), we convert our greyscale image to a purely black and white image by converting values below a threshold to <code class="docutils literal notranslate"><span class=pre >False</span></code> (and thus, effectively, to zero) and values above a threshold to <code class="docutils literal notranslate"><span class=pre >True</span></code> (and thus, effectively, to 1). Admittedly this doesn’t generate the most interesting image, but it does provide a simple illustration of how we can manipulate images by playing with the underlying numerical data.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[44]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=c1 ># Convert Greyscale to Two-Tone</span>
<span class=n >two_tone</span> <span class=o >=</span> <span class=n >jellyfish</span> <span class=o >&gt;</span> <span class=mf >0.3</span>
<span class=n >plt</span><span class=o >.</span><span class=n >imshow</span><span class=p >(</span><span class=n >two_tone</span><span class=p >,</span> <span class=n >cmap</span><span class=o >=</span><span class=s2 >"gray"</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[44]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
&lt;matplotlib.image.AxesImage at 0x1416f4850&gt;
</pre></div></div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <img alt="../../_images/30_numpy_20_matrices_25_images_as_matrices_11_1.png" src="../../_images/30_numpy_20_matrices_25_images_as_matrices_11_1.png"/> </div> </div> </section> <section id=Adjusting-Contrast > <h2 id=Adjusting-Contrast >Adjusting Contrast<a class=headerlink  href="#Adjusting-Contrast" title="Permalink to this headline">¶</a></h2> <p>We can also up the contrast without going all the way to a two-tone image, although we have to be a little more clever to do so. Can you think of how we might accomplish this?</p> <p>Stop before reading ahead for a minute and trying and think of a way of moving all the values in this matrix away from 0.5 towards 0 and 1.</p> <p>Seriously, think about it!</p> <p>Fundamentally, we increase contrast by moving values away from middle tones (greys) and towards the extremes of 0s (black) and 1 (white). So we need a function that’s going to take the current values, and disproportionately move values that are in the middle towards the extremes. In mathematical terms, we need a nonlinear transformation! Don’t worry if that doesn’t mean anything to you, or if the next section feels a little abstract or out of your comfort zone—this is mostly here to illustrate how mathematical manipulations of matrices give rise to the types of settings adjustments that you see in tools like Adobe Photoshop.</p> <p>In this case, let’s use one of the most simple nonlinear transformations: the square root function. When we take the square root of a positive number between 0 and 1, the result will increase in size by a larger amount the closer the original number is to 0 (while values close to 1 barely change). For example, if we raise values to 0.5 (in other words, take the square root of values), 0.1 becomes 0.31, while 0.9 only becomes 0.95. Here is the square root function illustrated graphically:</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[45]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >zero_to_one</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >arange</span><span class=p >(</span><span class=mi >0</span><span class=p >,</span> <span class=mi >1</span><span class=p >,</span> <span class=mf >0.01</span><span class=p >)</span>
<span class=n >plt</span><span class=o >.</span><span class=n >plot</span><span class=p >(</span><span class=n >zero_to_one</span><span class=p >,</span> <span class=n >np</span><span class=o >.</span><span class=n >sqrt</span><span class=p >(</span><span class=n >zero_to_one</span><span class=p >))</span>
</pre></div> </div> </div> <div class="nboutput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[45]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
[&lt;matplotlib.lines.Line2D at 0x1417686d0&gt;]
</pre></div></div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <img alt="../../_images/30_numpy_20_matrices_25_images_as_matrices_14_1.png" src="../../_images/30_numpy_20_matrices_25_images_as_matrices_14_1.png"/> </div> </div> <p>So to create a function that moves values that are close to 0.5 more than values that are close to 0 or 1, we need to do a couple little tricks. First, we subtract 0.5 from all of the values and our matrix so that the grey pixels now have a value of 0, blacks have a value of -0.5, and whites have a value of 0.5. Then we double all the values so black is -1 and white is 1.</p> <p>Now if we square the absolute values of all of our pixels (and make the pixels that had negative signs negative again), all the pixels that had values close to 0 will have moved significantly in the direction of -1 or 1, while values that were close to -1 or 1 will not have moved very much.</p> <p>Then we just reverse our shift and scaling (divided by two so the values lie between -0.5 and 0.5, then add 0.5 so they’re back being between 0 and 1), and we have our image with increased contrast!</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[47]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=k >def</span> <span class=nf >change_contrast</span><span class=p >(</span><span class=n >image</span><span class=p >):</span>
    <span class=c1 ># shift values so they lie between -1 and 1</span>
    <span class=n >re_center_and_re_scale</span> <span class=o >=</span> <span class=p >(</span><span class=n >image</span> <span class=o >-</span> <span class=mf >0.5</span><span class=p >)</span> <span class=o >*</span> <span class=mi >2</span>

    <span class=c1 ># take square root of absolute value</span>
    <span class=c1 ># (the square root of the negative number is undefined)</span>
    <span class=n >squared_values</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >abs</span><span class=p >(</span><span class=n >re_center_and_re_scale</span><span class=p >)</span> <span class=o >**</span> <span class=mf >0.5</span>

    <span class=c1 ># make the negative values negative again</span>
    <span class=n >correctly_signed_and_squared</span> <span class=o >=</span> <span class=n >squared_values</span> <span class=o >*</span> <span class=n >np</span><span class=o >.</span><span class=n >sign</span><span class=p >(</span><span class=n >re_center_and_re_scale</span><span class=p >)</span>

    <span class=c1 ># Shift back and rescale</span>
    <span class=n >shifted_and_scaled_back</span> <span class=o >=</span> <span class=p >(</span><span class=n >correctly_signed_and_squared</span> <span class=o >/</span> <span class=mi >2</span><span class=p >)</span> <span class=o >+</span> <span class=mf >0.5</span>
    <span class=k >return</span> <span class=n >shifted_and_scaled_back</span>


<span class=n >plt</span><span class=o >.</span><span class=n >imshow</span><span class=p >(</span><span class=n >change_contrast</span><span class=p >(</span><span class=n >jellyfish</span><span class=p >),</span> <span class=n >cmap</span><span class=o >=</span><span class=s2 >"gray"</span><span class=p >,</span> <span class=n >vmin</span><span class=o >=</span><span class=mi >0</span><span class=p >,</span> <span class=n >vmax</span><span class=o >=</span><span class=mi >1</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[47]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
&lt;matplotlib.image.AxesImage at 0x14181de10&gt;
</pre></div></div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <img alt="../../_images/30_numpy_20_matrices_25_images_as_matrices_16_1.png" src="../../_images/30_numpy_20_matrices_25_images_as_matrices_16_1.png"/> </div> </div> <p>Which we can compare to our original image:</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[48]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >plt</span><span class=o >.</span><span class=n >imshow</span><span class=p >(</span><span class=n >jellyfish</span><span class=p >,</span> <span class=n >cmap</span><span class=o >=</span><span class=s2 >"gray"</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[48]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
&lt;matplotlib.image.AxesImage at 0x14186f0a0&gt;
</pre></div></div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <img alt="../../_images/30_numpy_20_matrices_25_images_as_matrices_18_1.png" src="../../_images/30_numpy_20_matrices_25_images_as_matrices_18_1.png"/> </div> </div> <section id=Generalizing-Contrast-Adjustment > <h3 id=Generalizing-Contrast-Adjustment >Generalizing Contrast Adjustment<a class=headerlink  href="#Generalizing-Contrast-Adjustment" title="Permalink to this headline">¶</a></h3> <p>In fact, we can even generalize this trick—taking the square root of a number is the same as raising it to the power 0.5, and it turns out that raising numbers that lie between 0 and 1 to any exponent that is less than one will do this same trick, just to different degrees. So we can just make the exponent being used a parameter to our function.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[49]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=k >def</span> <span class=nf >change_contrast</span><span class=p >(</span><span class=n >image</span><span class=p >,</span> <span class=n >exponent</span><span class=o >=</span><span class=mf >0.5</span><span class=p >):</span>
    <span class=c1 ># shift values so they lie between -1 and 1</span>
    <span class=n >re_center_and_re_scale</span> <span class=o >=</span> <span class=p >(</span><span class=n >image</span> <span class=o >-</span> <span class=mf >0.5</span><span class=p >)</span> <span class=o >*</span> <span class=mi >2</span>

    <span class=c1 ># take square root of absolute value</span>
    <span class=c1 ># (the square root of the negative number is undefined)</span>
    <span class=n >squared_values</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >abs</span><span class=p >(</span><span class=n >re_center_and_re_scale</span><span class=p >)</span> <span class=o >**</span> <span class=n >exponent</span>

    <span class=c1 ># make the negative values negative again</span>
    <span class=n >correctly_signed_and_squared</span> <span class=o >=</span> <span class=n >squared_values</span> <span class=o >*</span> <span class=n >np</span><span class=o >.</span><span class=n >sign</span><span class=p >(</span><span class=n >re_center_and_re_scale</span><span class=p >)</span>

    <span class=c1 ># Shift back and rescale</span>
    <span class=n >shifted_and_scaled_back</span> <span class=o >=</span> <span class=p >(</span><span class=n >correctly_signed_and_squared</span> <span class=o >/</span> <span class=mi >2</span><span class=p >)</span> <span class=o >+</span> <span class=mf >0.5</span>
    <span class=k >return</span> <span class=n >shifted_and_scaled_back</span>


<span class=n >plt</span><span class=o >.</span><span class=n >imshow</span><span class=p >(</span><span class=n >change_contrast</span><span class=p >(</span><span class=n >jellyfish</span><span class=p >,</span> <span class=mf >0.25</span><span class=p >),</span> <span class=n >cmap</span><span class=o >=</span><span class=s2 >"gray"</span><span class=p >,</span> <span class=n >vmin</span><span class=o >=</span><span class=mi >0</span><span class=p >,</span> <span class=n >vmax</span><span class=o >=</span><span class=mi >1</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[49]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
&lt;matplotlib.image.AxesImage at 0x1418d6ce0&gt;
</pre></div></div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <img alt="../../_images/30_numpy_20_matrices_25_images_as_matrices_21_1.png" src="../../_images/30_numpy_20_matrices_25_images_as_matrices_21_1.png"/> </div> </div> <p>And in fact we can now use this function to <em>reduce</em> the image contrast by passing an exponent that is greater than one, which will have the exact opposite effect!</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[51]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=c1 ># decrease contrast with an exponent greater than one</span>
<span class=n >plt</span><span class=o >.</span><span class=n >imshow</span><span class=p >(</span><span class=n >change_contrast</span><span class=p >(</span><span class=n >jellyfish</span><span class=p >,</span> <span class=n >exponent</span><span class=o >=</span><span class=mi >2</span><span class=p >),</span> <span class=n >cmap</span><span class=o >=</span><span class=s2 >"gray"</span><span class=p >,</span> <span class=n >vmin</span><span class=o >=</span><span class=mi >0</span><span class=p >,</span> <span class=n >vmax</span><span class=o >=</span><span class=mi >1</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[51]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
&lt;matplotlib.image.AxesImage at 0x14198b670&gt;
</pre></div></div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <img alt="../../_images/30_numpy_20_matrices_25_images_as_matrices_23_1.png" src="../../_images/30_numpy_20_matrices_25_images_as_matrices_23_1.png"/> </div> </div> <p>Voilà! Now you can stop paying Photoshop for a license and edit all your photos yourself! OK, we’re probably not there yet, but this <em>is</em> precisely what programs like Photoshop are doing behind the scenes.</p> </section> </section> <section id=Color-Images > <h2 id=Color-Images >Color Images<a class=headerlink  href="#Color-Images" title="Permalink to this headline">¶</a></h2> <p>As you’ve hopefully seen with this greyscale image, thinking of images as matrices is a very powerful perspective and one that underlies all digital image processing.</p> <p>But how does this work with color images? The answer depends a little on the color encoding that a photo format uses, but for most formats, the color of a pixel can actually be represented by 3 numbers per pixel corresponding to the relative contributions of the primary colors of red, green, and blue that, added together, make up the final image. This can also be represented with numpy arrays, but as doing so requires using three-dimensional arrays (which we haven’t covered yet), we will defer discussion of color images for a little while. Don’t worry though, will come back to them!</p> </section> </section> </article> </div> </div> </main> </div> <footer class=md-footer > <div class=md-footer-nav > <nav class="md-footer-nav__inner md-grid"> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright > <div class=md-footer-copyright__highlight > &#169; Copyright 2021, Nick Eubank. </div> Created using <a href="http://www.sphinx-doc.org/">Sphinx</a> 4.5.0. and <a href="https://github.com/bashtage/sphinx-material/">Material for Sphinx</a> </div> </div> </div> </footer> <script src="../../_static/javascripts/application.js"></script> <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>