<!DOCTYPE html> <meta charset=utf-8  /> <meta name=viewport  content="width=device-width, initial-scale=1.0" /><meta name=generator  content="Docutils 0.17.1: http://docutils.sourceforge.net/" /> <meta name=viewport  content="width=device-width,initial-scale=1"> <meta http-equiv=x-ua-compatible  content="ie=edge"> <meta name="lang:clipboard.copy" content="Copy to clipboard"> <meta name="lang:clipboard.copied" content="Copied to clipboard"> <meta name="lang:search.language" content=en > <meta name="lang:search.pipeline.stopwords" content=True > <meta name="lang:search.pipeline.trimmer" content=True > <meta name="lang:search.result.none" content="No matching documents"> <meta name="lang:search.result.one" content="1 matching document"> <meta name="lang:search.result.other" content="# matching documents"> <meta name="lang:search.tokenizer" content="[\s\-]+"> <link href="https://fonts.gstatic.com/" rel=preconnect  crossorigin> <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel=stylesheet > <style> body, input { font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif } code, kbd, pre { font-family: "Roboto Mono", "Courier New", Courier, monospace } </style> <link rel=stylesheet  href="../_static/stylesheets/application.css"/> <link rel=stylesheet  href="../_static/stylesheets/application-palette.css"/> <link rel=stylesheet  href="../_static/stylesheets/application-fixes.css"/> <link rel=stylesheet  href="../_static/fonts/material-icons.css"/> <meta name=theme-color  content="#2196f3"> <script src="../_static/javascripts/modernizr.js"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-XX133829453-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'UA-XX133829453-1'); </script> <title>Dask DataFrames &#8212; Practical Data Science</title> <link rel=stylesheet  type="text/css" href="../_static/pygments.css" /> <link rel=stylesheet  type="text/css" href="../_static/material.css" /> <script data-url_root="../" id=documentation_options  src="../_static/documentation_options.js"></script> <script src="../_static/jquery.js"></script> <script src="../_static/underscore.js"></script> <script src="../_static/doctools.js"></script> <script crossorigin=anonymous  integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script> <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script> <script defer=defer  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <link rel="shortcut icon" href="../_static/mids_logo.svg"/> <link rel=index  title=Index  href="../genindex.html" /> <link rel=search  title=Search  href="../search.html" /> <body dir=ltr data-md-color-primary=blue-grey data-md-color-accent=blue> <svg class=md-svg > <defs data-children-count=0 > <svg xmlns="http://www.w3.org/2000/svg" width=416  height=448  viewBox="0 0 416 448" id=__github ><path fill=currentColor  d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle  data-md-toggle=drawer  type=checkbox  id=__drawer > <input class=md-toggle  data-md-toggle=search  type=checkbox  id=__search > <label class=md-overlay  data-md-component=overlay  for=__drawer ></label> <a href="#exercises/Exercise_dask" tabindex=1  class=md-skip > Skip to content </a> <header class=md-header  data-md-component=header > <nav class="md-header-nav md-grid"> <div class="md-flex navheader"> <div class="md-flex__cell md-flex__cell--shrink"> <a href="../index.html" title="Practical Data Science" class="md-header-nav__button md-logo"> <img src="../_static/mids_logo.svg" height=26  alt="Practical Data Science logo"> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer ></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title > <span class=md-header-nav__topic >Practical Data Science</span> <span class=md-header-nav__topic > Dask DataFrames </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search ></label> <div class=md-search  data-md-component=search  role=dialog > <label class=md-search__overlay  for=__search ></label> <div class=md-search__inner  role=search > <form class=md-search__form  action="../search.html" method=get  name=search > <input type=text  class=md-search__input  name=q  placeholder=""Search"" autocapitalize=off  autocomplete=off  spellcheck=false  data-md-component=query  data-md-state=active > <label class="md-icon md-search__icon" for=__search ></label> <button type=reset  class="md-icon md-search__icon" data-md-component=reset  tabindex=-1 > &#xE5CD; </button> </form> <div class=md-search__output > <div class=md-search__scrollwrap  data-md-scrollfix> <div class=md-search-result  data-md-component=result > <div class=md-search-result__meta > Type to start searching </div> <ol class=md-search-result__list ></ol> </div> </div> </div> </div> </div> </div> <script src="../_static/javascripts/version_dropdown.js"></script> <script> var json_loc = "../"versions.json"", target_loc = "../../", text = "Versions"; $( document ).ready( add_version_dropdown(json_loc, target_loc, text)); </script> </div> </nav> </header> <div class=md-container > <nav class=md-tabs  data-md-component=tabs > <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list > <li class=md-tabs__item ><a href="../index.html" class=md-tabs__link >Home</a> <li class=md-tabs__item ><a href="../class_schedule.html" class=md-tabs__link >Class Schedule</a> <li class=md-tabs__item ><a href="../topic_list.html" class=md-tabs__link >Topic List</a> <li class=md-tabs__item ><a href="https://www.nickeubank.com" class=md-tabs__link >About The Author</a> </ul> </div> </nav> <main class=md-main > <div class="md-main__inner md-grid" data-md-component=container > <div class="md-sidebar md-sidebar--primary" data-md-component=navigation > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--primary" data-md-level=0 > <label class="md-nav__title md-nav__title--site" for=__drawer > <a href="../index.html" title="Practical Data Science" class="md-nav__button md-logo"> <img src="../_static/mids_logo.svg" alt=" logo" width=48  height=48 > </a> <a href="../index.html" title="Practical Data Science">Practical Data Science</a> </label> <ul class=md-nav__list > <li class=md-nav__item > <a href="../class_schedule.html" class=md-nav__link >Class Schedule</a> <li class=md-nav__item > <a href="../autograder_guidelines.html" class=md-nav__link >Autograder Guidelines</a> <li class=md-nav__item > <a href="../not_a_mids_student.html" class=md-nav__link >Not a MIDS Student?</a> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--secondary"> <label class=md-nav__title  for=__toc >"Contents"</label> <ul class=md-nav__list  data-md-scrollfix=""> <li class=md-nav__item ><a href="#exercises-exercise-dask--page-root" class=md-nav__link >Dask DataFrames</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Install-Dask" class=md-nav__link >Install Dask</a> <li class=md-nav__item ><a href="#Start-your-own-cluster!" class=md-nav__link >Start your own cluster!</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Real-Data" class=md-nav__link >Real Data</a> <li class=md-nav__item ><a href="#What-just-happened?" class=md-nav__link >What just happened?</a> </ul> </nav> <li class=md-nav__item ><a href="#Computations-with-dask.dataframe" class=md-nav__link >Computations with <code class="docutils literal notranslate"><span class=pre >dask.dataframe</span></code></a> <li class=md-nav__item ><a href="#Let’s-do-some-manipulations!" class=md-nav__link >Let’s do some manipulations!</a> <li class=md-nav__item ><a href="#Sharing-Intermediate-Results" class=md-nav__link >Sharing Intermediate Results</a> <li class=md-nav__item ><a href="#Converting-Scheduled-Departure-Time-(CRSDepTime)-to-a-timestamp" class=md-nav__link >Converting Scheduled Departure Time (<code class="docutils literal notranslate"><span class=pre >CRSDepTime</span></code>) to a timestamp</a> <li class=md-nav__item ><a href="#Other-Things-to-Know" class=md-nav__link >Other Things to Know</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Persist-(caching)" class=md-nav__link >Persist (caching)</a> <li class=md-nav__item ><a href="#Using-Parquet" class=md-nav__link >Using Parquet</a> </ul> </nav> <li class=md-nav__item ><a href="#Limitations" class=md-nav__link >Limitations</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#What-doesn’t-work?" class=md-nav__link >What doesn’t work?</a> <li class=md-nav__item ><a href="#What-definitely-works?" class=md-nav__link >What definitely works?</a> </ul> </nav> </ul> </nav> </ul> </nav> </div> </div> </div> <div class=md-content > <article class="md-content__inner md-typeset" role=main > <style> /* CSS for nbsphinx extension */ /* remove conflicting styling from Sphinx themes */ div.nbinput.container div.prompt *, div.nboutput.container div.prompt *, div.nbinput.container div.input_area pre, div.nboutput.container div.output_area pre, div.nbinput.container div.input_area .highlight, div.nboutput.container div.output_area .highlight { border: none; padding: 0; margin: 0; box-shadow: none; } div.nbinput.container > div[class*=highlight], div.nboutput.container > div[class*=highlight] { margin: 0; } div.nbinput.container div.prompt *, div.nboutput.container div.prompt * { background: none; } div.nboutput.container div.output_area .highlight, div.nboutput.container div.output_area pre { background: unset; } div.nboutput.container div.output_area div.highlight { color: unset; /* override Pygments text color */ } /* avoid gaps between output lines */ div.nboutput.container div[class*=highlight] pre { line-height: normal; } /* input/output containers */ div.nbinput.container, div.nboutput.container { display: -webkit-flex; display: flex; align-items: flex-start; margin: 0; width: 100%; } @media (max-width: 540px) { div.nbinput.container, div.nboutput.container { flex-direction: column; } } /* input container */ div.nbinput.container { padding-top: 5px; } /* last container */ div.nblast.container { padding-bottom: 5px; } /* input prompt */ div.nbinput.container div.prompt pre { color: #307FC1; } /* output prompt */ div.nboutput.container div.prompt pre { color: #BF5B3D; } /* all prompts */ div.nbinput.container div.prompt, div.nboutput.container div.prompt { width: 4.5ex; padding-top: 5px; position: relative; user-select: none; } div.nbinput.container div.prompt > div, div.nboutput.container div.prompt > div { position: absolute; right: 0; margin-right: 0.3ex; } @media (max-width: 540px) { div.nbinput.container div.prompt, div.nboutput.container div.prompt { width: unset; text-align: left; padding: 0.4em; } div.nboutput.container div.prompt.empty { padding: 0; } div.nbinput.container div.prompt > div, div.nboutput.container div.prompt > div { position: unset; } } /* disable scrollbars on prompts */ div.nbinput.container div.prompt pre, div.nboutput.container div.prompt pre { overflow: hidden; } /* input/output area */ div.nbinput.container div.input_area, div.nboutput.container div.output_area { -webkit-flex: 1; flex: 1; overflow: auto; } @media (max-width: 540px) { div.nbinput.container div.input_area, div.nboutput.container div.output_area { width: 100%; } } /* input area */ div.nbinput.container div.input_area { border: 1px solid #e0e0e0; border-radius: 2px; /*background: #f5f5f5;*/ } /* override MathJax center alignment in output cells */ div.nboutput.container div[class*=MathJax] { text-align: left !important; } /* override sphinx.ext.imgmath center alignment in output cells */ div.nboutput.container div.math p { text-align: left; } /* standard error */ div.nboutput.container div.output_area.stderr { background: #fdd; } /* ANSI colors */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } div.nbinput.container div.input_area div[class*=highlight] > pre, div.nboutput.container div.output_area div[class*=highlight] > pre, div.nboutput.container div.output_area div[class*=highlight].math, div.nboutput.container div.output_area.rendered_html, div.nboutput.container div.output_area > div.output_javascript, div.nboutput.container div.output_area:not(.rendered_html) > img{ padding: 5px; margin: 0; } /* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */ div.nbinput.container div.input_area > div[class^='highlight'], div.nboutput.container div.output_area > div[class^='highlight']{ overflow-y: hidden; } /* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */ .prompt .copybtn { display: none; } /* Some additional styling taken form the Jupyter notebook CSS */ .jp-RenderedHTMLCommon table, div.rendered_html table { border: none; border-collapse: collapse; border-spacing: 0; color: black; font-size: 12px; table-layout: fixed; } .jp-RenderedHTMLCommon thead, div.rendered_html thead { border-bottom: 1px solid black; vertical-align: bottom; } .jp-RenderedHTMLCommon tr, .jp-RenderedHTMLCommon th, .jp-RenderedHTMLCommon td, div.rendered_html tr, div.rendered_html th, div.rendered_html td { text-align: right; vertical-align: middle; padding: 0.5em 0.5em; line-height: normal; white-space: normal; max-width: none; border: none; } .jp-RenderedHTMLCommon th, div.rendered_html th { font-weight: bold; } .jp-RenderedHTMLCommon tbody tr:nth-child(odd), div.rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .jp-RenderedHTMLCommon tbody tr:hover, div.rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } </style> <p><img alt="Dask logo\" class=no-scaled-link  src="http://dask.readthedocs.io/en/latest/_images/dask_horizontal.svg" width="30%"/></p> <section id=Dask-DataFrames > <h1 id=exercises-exercise-dask--page-root >Dask DataFrames<a class=headerlink  href="#exercises-exercise-dask--page-root" title="Permalink to this headline">¶</a></h1> <p>(Note: This tutorial is a fork of the official dask tutorial, which you can <a class="reference external" href="https://github.com/dask/dask-tutorial">find here</a>)</p> <p>In this tutorial, we will use <code class="docutils literal notranslate"><span class=pre >dask.dataframe</span></code> to do parallel operations on dask dataframes look and feel like Pandas dataframes but they run on the same infrastructure that powers <code class="docutils literal notranslate"><span class=pre >dask.delayed</span></code>.</p> <section id=Install-Dask > <h2 id=Install-Dask >Install Dask<a class=headerlink  href="#Install-Dask" title="Permalink to this headline">¶</a></h2> <p>Let’s start by installing dask with:</p> <div class="highlight-none notranslate"><div class=highlight ><pre><span></span>conda install -c conda-forge dask
</pre></div> </div> </section> <section id="Start-your-own-cluster!"> <h2 id="Start-your-own-cluster!">Start your own cluster!<a class=headerlink  href="#Start-your-own-cluster!" title="Permalink to this headline">¶</a></h2> <p>dask has many backends, but the one that’s most versitile (and often most performant) is the <code class="docutils literal notranslate"><span class=pre >distributed</span></code> backend, so let’s use that here. Run:</p> <div class="highlight-python notranslate"><div class=highlight ><pre><span></span><span class=kn >from</span> <span class=nn >dask.distributed</span> <span class=kn >import</span> <span class=n >Client</span>
<span class=n >client</span> <span class=o >=</span> <span class=n >Client</span><span class=p >()</span>
<span class=n >client</span>
</pre></div> </div> <p>to create a set of workers on your computer. This cluster is running only on your own computer, but it operates exactly the way it would work on a cloud cluster where these workers live on other computers.</p> <p>When you type <code class="docutils literal notranslate"><span class=pre >client</span></code> in a jupyter notebook, you should see the clusters status pop up like this:</p> <img alt=dask_status  src="images/dask_status.png"/> <p>This status tells me that I have four processes running on my computer, each of which running 4 threads (for 16 cores total). In addition, it tells me that the cluster sees that I have about 34GB of memory for it to play with.</p> <p>One cool thing you’ll see is that this panel includes a link to a Dashboard. Click this link, and a new tab will open in your browser that shows you, in real time, what your dask cluster is doing! We’ll come back to this later.</p> <p><strong>Note:</strong> these workers communication via networking protocols, so your firewall / anti-virus may ask if it’s ok to let Python accept connections (it is!). If you can’t get your system running, it may be due to your firewall / anti-virus. In that case, try <code class="docutils literal notranslate"><span class=pre >client</span> <span class=pre >=</span> <span class=pre >Client(processes=False)</span></code>. This will create four workers hiding in the same process (obviating the need for network protocols for communication between processes). Don’t worry if that last bit doesn’t make sense – those are implementation details you don’t ahve to worry about! :)</p> <img alt="dask network warning" src="images/dask_firewall.png"/> <p>Just authorize Python 3.10!</p> <section id=Real-Data > <h3 id=Real-Data >Real Data<a class=headerlink  href="#Real-Data" title="Permalink to this headline">¶</a></h3> <p>Lets try this with an extract of flights in the USA across several years. This data is specific to flights out of the three airports in the New York City area. To begin, download <a class="reference external" href="https://storage.googleapis.com/dask-tutorial-data/nycflights.tar.gz">NYC Flight data here</a>, and unzip it somewhere you can find it.</p> <p><strong>(1)</strong> Look at the data in the folder. As you will see it is in many files. Unlike pandas, however, dask can load collections of files all at once. Run <code class="docutils literal notranslate"><span class=pre >import</span> <span class=pre >dask.dataframe</span> <span class=pre >as</span> <span class=pre >dd</span></code>, then using <code class="docutils literal notranslate"><span class=pre >dd.read_csv</span></code> with an asterix wildcard to load all the files at once with something like:</p> <div class="highlight-python notranslate"><div class=highlight ><pre><span></span><span class=kn >import</span> <span class=nn >dask.dataframe</span> <span class=k >as</span> <span class=nn >dd</span>
<span class=n >df</span> <span class=o >=</span> <span class=n >dd</span><span class=o >.</span><span class=n >read_csv</span><span class=p >(</span><span class=s1 >'/users/nick/downloads/nycflights/*.csv'</span><span class=p >,</span>
                 <span class=n >parse_dates</span><span class=o >=</span><span class=p >{</span><span class=s1 >'Date'</span><span class=p >:</span> <span class=p >[</span><span class=mi >0</span><span class=p >,</span> <span class=mi >1</span><span class=p >,</span> <span class=mi >2</span><span class=p >]})</span>
</pre></div> </div> <p>(The <code class="docutils literal notranslate"><span class=pre >parse_dates</span></code> option just tells dask that columns 1, 2, and 3 together form a date (they’re year, month, and day of the month respectively), and that dask should convert them to a single column called <code class="docutils literal notranslate"><span class=pre >Date</span></code> that is of type datetime. This isn’t special to dask, it’s just a pandas <code class="docutils literal notranslate"><span class=pre >read_csv</span></code> option.)</p> <p><strong>(2)</strong> Look at your dataframe by just calling it (<code class="docutils literal notranslate"><span class=pre >df</span></code>). Notice that the respresentation of the dataframe object contains no data - Dask has just done enough to read the start of the first file, and infer the column names and types.</p> <p><strong>(3)</strong> now use <code class="docutils literal notranslate"><span class=pre >df.head()</span></code> to ask dask to actually load a few rows.</p> <p>We can view the start and end of the data</p> <p><strong>(4)</strong> Now try and run <code class="docutils literal notranslate"><span class=pre >df.tail()</span></code>.</p> </section> <section id="What-just-happened?"> <h3 id="What-just-happened?">What just happened?<a class=headerlink  href="#What-just-happened?" title="Permalink to this headline">¶</a></h3> <p>Unlike <code class="docutils literal notranslate"><span class=pre >pandas.read_csv</span></code> which reads in the entire file before inferring datatypes, <code class="docutils literal notranslate"><span class=pre >dask.dataframe.read_csv</span></code> only reads in a sample from the beginning of the file (or first file if using a glob). These inferred datatypes are then enforced when reading all partitions.</p> <p>In this case, the datatypes inferred in the sample are incorrect. The first <code class="docutils literal notranslate"><span class=pre >n</span></code> rows have no value for <code class="docutils literal notranslate"><span class=pre >CRSElapsedTime</span></code> (which pandas infers as a <code class="docutils literal notranslate"><span class=pre >float</span></code>), and later on turn out to be strings (<code class="docutils literal notranslate"><span class=pre >object</span></code> dtype). Note that Dask gives an informative error message about the mismatch. When this happens you have a few options:</p> <ul class=simple > <li><p>Specify dtypes directly using the <code class="docutils literal notranslate"><span class=pre >dtype</span></code> keyword. This is the recommended solution, as it’s the least error prone (better to be explicit than implicit) and also the most performant.</p> <li><p>Increase the size of the <code class="docutils literal notranslate"><span class=pre >sample</span></code> keyword (in bytes)</p> <li><p>Use <code class="docutils literal notranslate"><span class=pre >assume_missing</span></code> to make <code class="docutils literal notranslate"><span class=pre >dask</span></code> assume that columns inferred to be <code class="docutils literal notranslate"><span class=pre >int</span></code> (which don’t allow missing values) are actually floats (which do allow missing values). In our particular case this doesn’t apply.</p> </ul> <p>In our case we’ll use the first option and directly specify the <code class="docutils literal notranslate"><span class=pre >dtypes</span></code> of the offending columns: set <code class="docutils literal notranslate"><span class=pre >TailNum</span></code> to <code class="docutils literal notranslate"><span class=pre >str</span></code>, <code class="docutils literal notranslate"><span class=pre >CRSElapsedTime</span></code> to <code class="docutils literal notranslate"><span class=pre >float</span></code> and <code class="docutils literal notranslate"><span class=pre >Cancelled</span></code> to <code class="docutils literal notranslate"><span class=pre >bool</span></code>.</p> </section> </section> <section id=Computations-with-dask.dataframe > <h2 id=Computations-with-dask.dataframe >Computations with <code class="docutils literal notranslate"><span class=pre >dask.dataframe</span></code><a class=headerlink  href="#Computations-with-dask.dataframe" title="Permalink to this headline">¶</a></h2> <p>Suppose we want to compute the maximum of the <code class="docutils literal notranslate"><span class=pre >DepDelay</span></code> (short for Departure Delays) column. With just pandas, we would loop over each file to find the individual maximums, then find the final maximum over all the individual maximums</p> <div class="highlight-python notranslate"><div class=highlight ><pre><span></span><span class=n >maxes</span> <span class=o >=</span> <span class=p >[]</span>
<span class=k >for</span> <span class=n >fn</span> <span class=ow >in</span> <span class=n >filenames</span><span class=p >:</span>
    <span class=n >df</span> <span class=o >=</span> <span class=n >pd</span><span class=o >.</span><span class=n >read_csv</span><span class=p >(</span><span class=n >fn</span><span class=p >)</span>
    <span class=n >maxes</span><span class=o >.</span><span class=n >append</span><span class=p >(</span><span class=n >df</span><span class=o >.</span><span class=n >DepDelay</span><span class=o >.</span><span class=n >max</span><span class=p >())</span>

<span class=n >final_max</span> <span class=o >=</span> <span class=nb >max</span><span class=p >(</span><span class=n >maxes</span><span class=p >)</span>
</pre></div> </div> <p>But this is a far cry from what we do with smaller pandas dataset, which is just</p> <div class="highlight-python notranslate"><div class=highlight ><pre><span></span><span class=n >df</span> <span class=o >=</span> <span class=n >pd</span><span class=o >.</span><span class=n >read_csv</span><span class=p >(</span><span class=n >filename</span><span class=p >,</span> <span class=n >dtype</span><span class=o >=</span><span class=n >dtype</span><span class=p >)</span>
<span class=n >df</span><span class=o >.</span><span class=n >DepDelay</span><span class=o >.</span><span class=n >max</span><span class=p >()</span>
</pre></div> </div> <p>To solve this, we can use <code class="docutils literal notranslate"><span class=pre >dask</span></code>! <code class="docutils literal notranslate"><span class=pre >dask.dataframe</span></code> lets us write pandas-like code, that operates on larger than memory datasets in parallel. To get the maximium value of the column, we can run:</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[ ]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=o >%</span><span class=k >time</span> df.DepDelay.max().compute()
</pre></div> </div> </div> <div class="nboutput docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
CPU times: user 127 ms, sys: 29.9 ms, total: 157 ms
Wall time: 1.98 s
</pre></div></div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
1435.0
</pre></div></div> </div> <p>This writes the delayed computation for us and then runs it.</p> <p>Some things to note:</p> <ol class="arabic simple"> <li><p>Dask uses lazy evaluation, which means it doesn’t actually do any work till we call <code class="docutils literal notranslate"><span class=pre >.compute()</span></code>. If you just ran <code class="docutils literal notranslate"><span class=pre >df.DepDelay.max()</span></code>, you’d just get back a placeholder:</p> </ol> <div class="highlight-python notranslate"><div class=highlight ><pre><span></span><span class=o >&gt;</span> <span class=n >df</span><span class=o >.</span><span class=n >DepDelay</span><span class=o >.</span><span class=n >max</span><span class=p >()</span>

<span class=n >dd</span><span class=o >.</span><span class=n >Scalar</span><span class=o >&lt;</span><span class=n >series</span><span class=o >-...</span><span class=p >,</span> <span class=n >dtype</span><span class=o >=</span><span class=n >float64</span><span class=o >&gt;</span>
</pre></div> </div> <ol class="arabic simple" start=2 > <li><p>Dask will delete intermediate results (like the full pandas dataframe for each file) as soon as possible.</p> <ul class=simple > <li><p>This lets us handle datasets that are larger than memory</p> <li><p>This means that repeated computations will have to load all of the data in each time (run the code above again, is it faster or slower than you would expect?)</p> </ul> </ol> <p><strong>(5)</strong> Want to know more about what dask is doing? First, just store <code class="docutils literal notranslate"><span class=pre >df.DepDelay.max()</span></code> as a new variable and look at it. Can you see the placeholder? It tells you what it will eventually be (a scalar (single value) float64). But you don’t see the actual maximum value.</p> <p><strong>(6)</strong> You can actually see how dask is developing a plan for getting you the maximum value if you were to run your code right now. We do this with the <code class="docutils literal notranslate"><span class=pre >.dask</span></code> attribute, which you can run on any dask object before you’ve run <code class="docutils literal notranslate"><span class=pre >.compute()</span></code>.</p> <p><a class="reference external" href="https://docs.dask.org/en/stable/graphviz.html#visualize-the-low-level-graph">For more on task graphs, see here.</a></p> </section> <section id="Let’s-do-some-manipulations!"> <h2 id="Let’s-do-some-manipulations!">Let’s do some manipulations!<a class=headerlink  href="#Let’s-do-some-manipulations!" title="Permalink to this headline">¶</a></h2> <p>In this section we do a few <code class="docutils literal notranslate"><span class=pre >dask.dataframe</span></code> computations. If you are comfortable with Pandas then these should be familiar. You will have to think about when to call <code class="docutils literal notranslate"><span class=pre >.compute()</span></code>.</p> <p>When you run <code class="docutils literal notranslate"><span class=pre >.compute()</span></code>, you can also move over to your Dashboard (remember that link in the panel that openned when you created <code class="docutils literal notranslate"><span class=pre >client</span></code>?) to see your cluster working!</p> <p><strong>(7)</strong> In total, what is the average delay (<code class="docutils literal notranslate"><span class=pre >DepDelay</span></code>) for non-canceled flights?</p> <p><strong>(8)</strong> In total, how many non-cancelled flights were taken from each airport?</p> <p><em>Hint</em>: use <code class="docutils literal notranslate"><span class=pre >df.groupby</span></code> and <code class="docutils literal notranslate"><span class=pre >size</span></code>.</p> <p><strong>(9)</strong> What was the average departure delay from each airport? (<code class="docutils literal notranslate"><span class=pre >DepDelay</span></code>)</p> <p><strong>(10)</strong> How many rows are in our dataset?</p> <p>Note you’ve probably just found what I think is one of the trickiest things to figure out with a distributed computing system like dask: <em>some</em> functions don’t follow the rules of delayed evaluation, and when you run them, dask executes immediately. <code class="docutils literal notranslate"><span class=pre >len</span></code> is one of those functions.</p> <p>As we’ll discuss below, a good rule of thumb is that anything that isn’t either (a) a method on the dask dataframe (i.e. something that isn’t of the form <code class="docutils literal notranslate"><span class=pre >df.METHOD()</span></code>), or an explicit dask function (something you call from the dask library, like <code class="docutils literal notranslate"><span class=pre >dd.to_parquet</span></code>), it will probably execute immediately.</p> <p><code class="docutils literal notranslate"><span class=pre >len</span></code> is pretty safe since all it returns is a single number, so it’s unlikely to blow up your computer if it runs before you want, but you have to be careful with other functions, because if you were to us a pandas function like <code class="docutils literal notranslate"><span class=pre >pd.to_numeric(df)</span></code>, it will execute immediately, and it will do so by pulling all the data into your client session as a single giant dataframe, and with a larger dataset, it is likely to crash you computer when you do so.</p> <p>An alternative that <em>won’t</em> execute until you run <code class="docutils literal notranslate"><span class=pre >compute</span></code> is <code class="docutils literal notranslate"><span class=pre >df.shape[0]</span></code> (see how it takes the form of a method on our dask dataframe <code class="docutils literal notranslate"><span class=pre >df</span></code>?) Try it to see!</p> </section> <section id=Sharing-Intermediate-Results > <h2 id=Sharing-Intermediate-Results >Sharing Intermediate Results<a class=headerlink  href="#Sharing-Intermediate-Results" title="Permalink to this headline">¶</a></h2> <p>When computing all of the above, we sometimes did the same operation more than once. For most operations, <code class="docutils literal notranslate"><span class=pre >dask.dataframe</span></code> hashes the arguments, allowing duplicate computations to be shared, and only computed once.</p> <p>For example, lets compute the mean and standard deviation for departure delay of all non-canceled flights. Since dask operations are lazy, those values aren’t the final results yet. They’re just the recipe required to get the result.</p> <p>If we compute them with two calls to compute, there is no sharing of intermediate computations.</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[ ]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >non_cancelled</span> <span class=o >=</span> <span class=n >df</span><span class=p >[</span><span class=o >~</span><span class=n >df</span><span class=o >.</span><span class=n >Cancelled</span><span class=p >]</span>
<span class=n >mean_delay</span> <span class=o >=</span> <span class=n >non_cancelled</span><span class=o >.</span><span class=n >DepDelay</span><span class=o >.</span><span class=n >mean</span><span class=p >()</span>
<span class=n >std_delay</span> <span class=o >=</span> <span class=n >non_cancelled</span><span class=o >.</span><span class=n >DepDelay</span><span class=o >.</span><span class=n >std</span><span class=p >()</span>
</pre></div> </div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[ ]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=o >%%time</span>

<span class=n >mean_delay_res</span> <span class=o >=</span> <span class=n >mean_delay</span><span class=o >.</span><span class=n >compute</span><span class=p >()</span>
<span class=n >std_delay_res</span> <span class=o >=</span> <span class=n >std_delay</span><span class=o >.</span><span class=n >compute</span><span class=p >()</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
CPU times: user 376 ms, sys: 43.4 ms, total: 419 ms
Wall time: 3.88 s
</pre></div></div> </div> <p>But lets try by passing both to a single <code class="docutils literal notranslate"><span class=pre >compute</span></code> call.</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[ ]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=kn >import</span> <span class=nn >dask</span>
</pre></div> </div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[ ]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=o >%%time</span>

<span class=n >mean_delay_res</span><span class=p >,</span> <span class=n >std_delay_res</span> <span class=o >=</span> <span class=n >dask</span><span class=o >.</span><span class=n >compute</span><span class=p >(</span><span class=n >mean_delay</span><span class=p >,</span> <span class=n >std_delay</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
CPU times: user 237 ms, sys: 26.5 ms, total: 264 ms
Wall time: 2 s
</pre></div></div> </div> <p>Using <code class="docutils literal notranslate"><span class=pre >dask.compute</span></code> takes roughly 1/2 the time. This is because the task graphs for both results are merged when calling <code class="docutils literal notranslate"><span class=pre >dask.compute</span></code>, allowing shared operations to only be done once instead of twice. In particular, using <code class="docutils literal notranslate"><span class=pre >dask.compute</span></code> only does the following once:</p> <ul class=simple > <li><p>the calls to <code class="docutils literal notranslate"><span class=pre >read_csv</span></code></p> <li><p>the filter (<code class="docutils literal notranslate"><span class=pre >df[~df.Cancelled]</span></code>)</p> <li><p>some of the necessary reductions (<code class="docutils literal notranslate"><span class=pre >sum</span></code>, <code class="docutils literal notranslate"><span class=pre >count</span></code>)</p> </ul> <p>To see what the merged task graphs between multiple results look like (and what’s shared), you can use the <code class="docutils literal notranslate"><span class=pre >dask.visualize</span></code> function (we might want to use <code class="docutils literal notranslate"><span class=pre >filename='graph.pdf'</span></code> to zoom in on the graph better):</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[ ]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >dask</span><span class=o >.</span><span class=n >visualize</span><span class=p >(</span><span class=n >mean_delay</span><span class=p >,</span> <span class=n >std_delay</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <img alt="../_images/exercises_Exercise_dask_26_0.png" src="../_images/exercises_Exercise_dask_26_0.png"/> </div> </div> <p>But lets try by passing both to a single <code class="docutils literal notranslate"><span class=pre >compute</span></code> call.</p> <p><strong>(11)</strong> Now you try – for each airport, get both the average delay and the maximum delay in the data for flights that weren’t cancelled.</p> <p>(As another example of places that distributed computing gets tricky, while it’s easy to do means and maxes, you can’t easily get the median of a group (e.g.<code class="docutils literal notranslate"><span class=pre >df.groupby('Origin)['DepDelay'].median()</span></code>) in a distributed manner. There are workarounds, but these are the kinds of “fragile” things that make distributed computing a bit of a pain).</p> </section> <section id="Converting-Scheduled-Departure-Time-(CRSDepTime)-to-a-timestamp"> <h2 id="Converting-Scheduled-Departure-Time-(CRSDepTime)-to-a-timestamp">Converting Scheduled Departure Time (<code class="docutils literal notranslate"><span class=pre >CRSDepTime</span></code>) to a timestamp<a class=headerlink  href="#Converting-Scheduled-Departure-Time-(CRSDepTime)-to-a-timestamp" title="Permalink to this headline">¶</a></h2> <p>This dataset stores the scheduled departure times of flights in the format <code class="docutils literal notranslate"><span class=pre >HHMM</span></code>, which are read in as integers in <code class="docutils literal notranslate"><span class=pre >read_csv</span></code>:</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[ ]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >crs_dep_time</span> <span class=o >=</span> <span class=n >df</span><span class=o >.</span><span class=n >CRSDepTime</span><span class=o >.</span><span class=n >head</span><span class=p >(</span><span class=mi >10</span><span class=p >)</span>
<span class=n >crs_dep_time</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
0    1540
1    1540
2    1540
3    1540
4    1540
5    1540
6    1540
7    1540
8    1540
9    1540
Name: CRSDepTime, dtype: int64
</pre></div></div> </div> <p>To combine the data we have on flight dates with these departure times into a single column that includes all that information in a single <code class="docutils literal notranslate"><span class=pre >datetime</span></code> format, we have to convert the time of day into a Timedelta type, then add those Timedeltas to our Date column to get a single column that knows the date AND time of day of departures. (Implicitly, dates think of themselves as living at midnight, so adding a timedelta of 10 hours moves them to 10am).</p> <p>To convert these to timestamps of scheduled departure time, we need to convert these integers into <code class="docutils literal notranslate"><span class=pre >pd.Timedelta</span></code> objects, and then combine them with the <code class="docutils literal notranslate"><span class=pre >Date</span></code> column.</p> <p>In pandas we’d do this using the <code class="docutils literal notranslate"><span class=pre >pd.to_timedelta</span></code> function, and a bit of arithmetic:</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[ ]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=kn >import</span> <span class=nn >pandas</span> <span class=k >as</span> <span class=nn >pd</span>

<span class=c1 ># Get the first 10 dates to complement our `crs_dep_time`</span>
<span class=n >date</span> <span class=o >=</span> <span class=n >df</span><span class=o >.</span><span class=n >Date</span><span class=o >.</span><span class=n >head</span><span class=p >(</span><span class=mi >10</span><span class=p >)</span>

<span class=c1 ># Get hours as an integer, convert to a timedelta</span>
<span class=n >hours</span> <span class=o >=</span> <span class=n >crs_dep_time</span> <span class=o >//</span> <span class=mi >100</span>
<span class=n >hours_timedelta</span> <span class=o >=</span> <span class=n >pd</span><span class=o >.</span><span class=n >to_timedelta</span><span class=p >(</span><span class=n >hours</span><span class=p >,</span> <span class=n >unit</span><span class=o >=</span><span class=s1 >'h'</span><span class=p >)</span>

<span class=c1 ># Get minutes as an integer, convert to a timedelta</span>
<span class=n >minutes</span> <span class=o >=</span> <span class=n >crs_dep_time</span> <span class=o >%</span> <span class=mi >100</span>
<span class=n >minutes_timedelta</span> <span class=o >=</span> <span class=n >pd</span><span class=o >.</span><span class=n >to_timedelta</span><span class=p >(</span><span class=n >minutes</span><span class=p >,</span> <span class=n >unit</span><span class=o >=</span><span class=s1 >'m'</span><span class=p >)</span>

<span class=c1 ># Apply the timedeltas to offset the dates by the departure time</span>
<span class=n >departure_timestamp</span> <span class=o >=</span> <span class=n >date</span> <span class=o >+</span> <span class=n >hours_timedelta</span> <span class=o >+</span> <span class=n >minutes_timedelta</span>
<span class=n >departure_timestamp</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
0   1990-01-01 15:40:00
1   1990-01-02 15:40:00
2   1990-01-03 15:40:00
3   1990-01-04 15:40:00
4   1990-01-05 15:40:00
5   1990-01-06 15:40:00
6   1990-01-07 15:40:00
7   1990-01-08 15:40:00
8   1990-01-09 15:40:00
9   1990-01-10 15:40:00
dtype: datetime64[ns]
</pre></div></div> </div> </section> <section id=Other-Things-to-Know > <h2 id=Other-Things-to-Know >Other Things to Know<a class=headerlink  href="#Other-Things-to-Know" title="Permalink to this headline">¶</a></h2> <section id="Persist-(caching)"> <h3 id="Persist-(caching)">Persist (caching)<a class=headerlink  href="#Persist-(caching)" title="Permalink to this headline">¶</a></h3> <p>Sometimes you want your computers to keep intermediate results in memory (when it’s possible). To “cache” data in this manner, you can to use the <code class="docutils literal notranslate"><span class=pre >persist()</span></code> method to tell dask what results you want to keep around. You can read <a class="reference external" href="https://docs.dask.org/en/latest/dataframe-best-practices.html#persist-intelligently">more here</a>.</p> </section> <section id=Using-Parquet > <h3 id=Using-Parquet >Using Parquet<a class=headerlink  href="#Using-Parquet" title="Permalink to this headline">¶</a></h3> <p>Dask works really efficiently with data stored in parquet format, <a class="reference external" href="https://docs.dask.org/en/latest/dataframe-best-practices.html#store-data-in-apache-parquet-format">as noted here</a>, so keeping data in parquet (as I’ve <a class="reference internal" href="../parquet.html"><span class=doc >suggested you do anyway</span></a>!) will help you with dask.</p> </section> </section> <section id=Limitations > <h2 id=Limitations >Limitations<a class=headerlink  href="#Limitations" title="Permalink to this headline">¶</a></h2> <section id="What-doesn’t-work?"> <h3 id="What-doesn’t-work?">What doesn’t work?<a class=headerlink  href="#What-doesn’t-work?" title="Permalink to this headline">¶</a></h3> <p>Dask.dataframe only covers a small but well-used portion of the Pandas API. This limitation is for two reasons:</p> <ol class="arabic simple"> <li><p>The Pandas API is <em>huge</em></p> <li><p>Some operations are genuinely hard to do in parallel (e.g. sort)</p> </ol> <p>Additionally, some important operations like <code class="docutils literal notranslate"><span class=pre >set_index</span></code> work, but are slower than in Pandas because they include substantial shuffling of data, and may write out to disk.</p> </section> <section id="What-definitely-works?"> <h3 id="What-definitely-works?">What definitely works?<a class=headerlink  href="#What-definitely-works?" title="Permalink to this headline">¶</a></h3> <ul class=simple > <li><p>Trivially parallelizable operations (fast):</p> <ul> <li><p>Elementwise operations: <code class="docutils literal notranslate"><span class=pre >df.x</span> <span class=pre >+</span> <span class=pre >df.y</span></code></p> <li><p>Row-wise selections: <code class="docutils literal notranslate"><span class=pre >df[df.x</span> <span class=pre >&gt;</span> <span class=pre >0]</span></code></p> <li><p>Loc: <code class="docutils literal notranslate"><span class=pre >df.loc[4.0:10.5]</span></code></p> <li><p>Common aggregations: <code class="docutils literal notranslate"><span class=pre >df.x.max()</span></code></p> <li><p>Is in: <code class="docutils literal notranslate"><span class=pre >df[df.x.isin([1,</span> <span class=pre >2,</span> <span class=pre >3])]</span></code></p> <li><p>Datetime/string accessors: <code class="docutils literal notranslate"><span class=pre >df.timestamp.month</span></code></p> </ul> <li><p>Cleverly parallelizable operations (also fast):</p> <ul> <li><p>groupby-aggregate (with common aggregations): <code class="docutils literal notranslate"><span class=pre >df.groupby(df.x).y.max()</span></code></p> <li><p>value_counts: <code class="docutils literal notranslate"><span class=pre >df.x.value_counts</span></code></p> <li><p>Drop duplicates: <code class="docutils literal notranslate"><span class=pre >df.x.drop_duplicates()</span></code></p> <li><p>Join on index: <code class="docutils literal notranslate"><span class=pre >dd.merge(df1,</span> <span class=pre >df2,</span> <span class=pre >left_index=True,</span> <span class=pre >right_index=True)</span></code></p> </ul> <li><p>Operations requiring a shuffle (slow-ish, unless on index)</p> <ul> <li><p>Set index: <code class="docutils literal notranslate"><span class=pre >df.set_index(df.x)</span></code></p> <li><p>groupby-apply (with anything): <code class="docutils literal notranslate"><span class=pre >df.groupby(df.x).apply(myfunc)</span></code></p> <li><p>Join not on the index: <code class="docutils literal notranslate"><span class=pre >pd.merge(df1,</span> <span class=pre >df2,</span> <span class=pre >on='name')</span></code></p> </ul> <li><p>Ingest operations</p> <ul> <li><p>Files: <code class="docutils literal notranslate"><span class=pre >dd.read_csv,</span> <span class=pre >dd.read_parquet,</span> <span class=pre >dd.read_json,</span> <span class=pre >dd.read_orc</span></code>, etc.</p> <li><p>Pandas: <code class="docutils literal notranslate"><span class=pre >dd.from_pandas</span></code></p> <li><p>Anything supporting numpy slicing: <code class="docutils literal notranslate"><span class=pre >dd.from_array</span></code></p> <li><p>From any set of functions creating sub dataframes via <code class="docutils literal notranslate"><span class=pre >dd.from_delayed</span></code>.</p> <li><p>Dask.bag: <code class="docutils literal notranslate"><span class=pre >mybag.to_dataframe(columns=[...])</span></code></p> </ul> </ul> </section> </section> </section> </article> </div> </div> </main> </div> <footer class=md-footer > <div class=md-footer-nav > <nav class="md-footer-nav__inner md-grid"> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright > <div class=md-footer-copyright__highlight > &#169; Copyright 2021, Nick Eubank. </div> Created using <a href="http://www.sphinx-doc.org/">Sphinx</a> 4.5.0. and <a href="https://github.com/bashtage/sphinx-material/">Material for Sphinx</a> </div> </div> </div> </footer> <script src="../_static/javascripts/application.js"></script> <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>