<!DOCTYPE html> <meta charset=utf-8  /> <meta name=viewport  content="width=device-width, initial-scale=1.0" /><meta name=generator  content="Docutils 0.17.1: http://docutils.sourceforge.net/" /> <meta name=viewport  content="width=device-width,initial-scale=1"> <meta http-equiv=x-ua-compatible  content="ie=edge"> <meta name="lang:clipboard.copy" content="Copy to clipboard"> <meta name="lang:clipboard.copied" content="Copied to clipboard"> <meta name="lang:search.language" content=en > <meta name="lang:search.pipeline.stopwords" content=True > <meta name="lang:search.pipeline.trimmer" content=True > <meta name="lang:search.result.none" content="No matching documents"> <meta name="lang:search.result.one" content="1 matching document"> <meta name="lang:search.result.other" content="# matching documents"> <meta name="lang:search.tokenizer" content="[\s\-]+"> <link href="https://fonts.gstatic.com/" rel=preconnect  crossorigin> <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel=stylesheet > <style> body, input { font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif } code, kbd, pre { font-family: "Roboto Mono", "Courier New", Courier, monospace } </style> <link rel=stylesheet  href="_static/stylesheets/application.css"/> <link rel=stylesheet  href="_static/stylesheets/application-palette.css"/> <link rel=stylesheet  href="_static/stylesheets/application-fixes.css"/> <link rel=stylesheet  href="_static/fonts/material-icons.css"/> <meta name=theme-color  content="#2196f3"> <script src="_static/javascripts/modernizr.js"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-XX133829453-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'UA-XX133829453-1'); </script> <title>Big Data Strategies &#8212; Practical Data Science</title> <link rel=stylesheet  type="text/css" href="_static/pygments.css" /> <link rel=stylesheet  type="text/css" href="_static/material.css" /> <script data-url_root="./" id=documentation_options  src="_static/documentation_options.js"></script> <script src="_static/jquery.js"></script> <script src="_static/underscore.js"></script> <script src="_static/doctools.js"></script> <script crossorigin=anonymous  integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script> <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script> <script defer=defer  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <link rel="shortcut icon" href="_static/mids_logo.svg"/> <link rel=index  title=Index  href=genindex.html  /> <link rel=search  title=Search  href=search.html  /> <body dir=ltr data-md-color-primary=blue-grey data-md-color-accent=blue> <svg class=md-svg > <defs data-children-count=0 > <svg xmlns="http://www.w3.org/2000/svg" width=416  height=448  viewBox="0 0 416 448" id=__github ><path fill=currentColor  d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle  data-md-toggle=drawer  type=checkbox  id=__drawer > <input class=md-toggle  data-md-toggle=search  type=checkbox  id=__search > <label class=md-overlay  data-md-component=overlay  for=__drawer ></label> <a href="#big_data_strategies" tabindex=1  class=md-skip > Skip to content </a> <header class=md-header  data-md-component=header > <nav class="md-header-nav md-grid"> <div class="md-flex navheader"> <div class="md-flex__cell md-flex__cell--shrink"> <a href=index.html  title="Practical Data Science" class="md-header-nav__button md-logo"> <img src="_static/mids_logo.svg" height=26  alt="Practical Data Science logo"> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer ></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title > <span class=md-header-nav__topic >Practical Data Science</span> <span class=md-header-nav__topic > Big Data Strategies </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search ></label> <div class=md-search  data-md-component=search  role=dialog > <label class=md-search__overlay  for=__search ></label> <div class=md-search__inner  role=search > <form class=md-search__form  action=search.html  method=get  name=search > <input type=text  class=md-search__input  name=q  placeholder=Search  autocapitalize=off  autocomplete=off  spellcheck=false  data-md-component=query  data-md-state=active > <label class="md-icon md-search__icon" for=__search ></label> <button type=reset  class="md-icon md-search__icon" data-md-component=reset  tabindex=-1 > &#xE5CD; </button> </form> <div class=md-search__output > <div class=md-search__scrollwrap  data-md-scrollfix> <div class=md-search-result  data-md-component=result > <div class=md-search-result__meta > Type to start searching </div> <ol class=md-search-result__list ></ol> </div> </div> </div> </div> </div> </div> <script src="_static/javascripts/version_dropdown.js"></script> <script> var json_loc = ""versions.json"", target_loc = "../", text = "Versions"; $( document ).ready( add_version_dropdown(json_loc, target_loc, text)); </script> </div> </nav> </header> <div class=md-container > <nav class=md-tabs  data-md-component=tabs > <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list > <li class=md-tabs__item ><a href=index.html  class=md-tabs__link >Home</a> <li class=md-tabs__item ><a href=class_schedule.html  class=md-tabs__link >Class Schedule</a> <li class=md-tabs__item ><a href=topic_list.html  class=md-tabs__link >Topic List</a> <li class=md-tabs__item ><a href="https://www.nickeubank.com" class=md-tabs__link >About The Author</a> </ul> </div> </nav> <main class=md-main > <div class="md-main__inner md-grid" data-md-component=container > <div class="md-sidebar md-sidebar--primary" data-md-component=navigation > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--primary" data-md-level=0 > <label class="md-nav__title md-nav__title--site" for=__drawer > <a href=index.html  title="Practical Data Science" class="md-nav__button md-logo"> <img src="_static/mids_logo.svg" alt=" logo" width=48  height=48 > </a> <a href=index.html  title="Practical Data Science">Practical Data Science</a> </label> <ul class=md-nav__list > <li class=md-nav__item > <a href=class_schedule.html  class=md-nav__link >Class Schedule</a> <li class=md-nav__item > <a href=autograder_guidelines.html  class=md-nav__link >Autograder Guidelines</a> <li class=md-nav__item > <a href=not_a_mids_student.html  class=md-nav__link >Not a MIDS Student?</a> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--secondary"> <label class=md-nav__title  for=__toc >Contents</label> <ul class=md-nav__list  data-md-scrollfix=""> <li class=md-nav__item ><a href="#big-data-strategies--page-root" class=md-nav__link >Big Data Strategies</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Step-1:-Do-I-Have-“Big-Data”?" class=md-nav__link >Step 1: Do I Have “Big Data”?</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#So-how-do-I-check-to-see-if-my-data-is-fitting-in-memory?" class=md-nav__link >So how do I check to see if my data is fitting in memory?</a> </ul> </nav> <li class=md-nav__item ><a href="#Step-2:-Pick-a-Strategy" class=md-nav__link >Step 2: Pick a Strategy</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Strategy-1:-Trim-till-it-fits" class=md-nav__link >Strategy 1: Trim till it fits</a> <li class=md-nav__item ><a href="#Strategy-2:-Pay-for-More-Memory" class=md-nav__link >Strategy 2: Pay for More Memory</a> <li class=md-nav__item ><a href="#Strategy-3:-Minimize-disk-access-penalties." class=md-nav__link >Strategy 3: Minimize disk-access penalties.</a> <li class=md-nav__item ><a href="#Strategy-4:-Distributed-Computing" class=md-nav__link >Strategy 4: Distributed Computing</a> </ul> </nav> <li class=md-nav__item ><a href="#Exercises!" class=md-nav__link >Exercises!</a> </ul> </nav> </ul> </nav> </div> </div> </div> <div class=md-content > <article class="md-content__inner md-typeset" role=main > <style> /* CSS for nbsphinx extension */ /* remove conflicting styling from Sphinx themes */ div.nbinput.container div.prompt *, div.nboutput.container div.prompt *, div.nbinput.container div.input_area pre, div.nboutput.container div.output_area pre, div.nbinput.container div.input_area .highlight, div.nboutput.container div.output_area .highlight { border: none; padding: 0; margin: 0; box-shadow: none; } div.nbinput.container > div[class*=highlight], div.nboutput.container > div[class*=highlight] { margin: 0; } div.nbinput.container div.prompt *, div.nboutput.container div.prompt * { background: none; } div.nboutput.container div.output_area .highlight, div.nboutput.container div.output_area pre { background: unset; } div.nboutput.container div.output_area div.highlight { color: unset; /* override Pygments text color */ } /* avoid gaps between output lines */ div.nboutput.container div[class*=highlight] pre { line-height: normal; } /* input/output containers */ div.nbinput.container, div.nboutput.container { display: -webkit-flex; display: flex; align-items: flex-start; margin: 0; width: 100%; } @media (max-width: 540px) { div.nbinput.container, div.nboutput.container { flex-direction: column; } } /* input container */ div.nbinput.container { padding-top: 5px; } /* last container */ div.nblast.container { padding-bottom: 5px; } /* input prompt */ div.nbinput.container div.prompt pre { color: #307FC1; } /* output prompt */ div.nboutput.container div.prompt pre { color: #BF5B3D; } /* all prompts */ div.nbinput.container div.prompt, div.nboutput.container div.prompt { width: 4.5ex; padding-top: 5px; position: relative; user-select: none; } div.nbinput.container div.prompt > div, div.nboutput.container div.prompt > div { position: absolute; right: 0; margin-right: 0.3ex; } @media (max-width: 540px) { div.nbinput.container div.prompt, div.nboutput.container div.prompt { width: unset; text-align: left; padding: 0.4em; } div.nboutput.container div.prompt.empty { padding: 0; } div.nbinput.container div.prompt > div, div.nboutput.container div.prompt > div { position: unset; } } /* disable scrollbars on prompts */ div.nbinput.container div.prompt pre, div.nboutput.container div.prompt pre { overflow: hidden; } /* input/output area */ div.nbinput.container div.input_area, div.nboutput.container div.output_area { -webkit-flex: 1; flex: 1; overflow: auto; } @media (max-width: 540px) { div.nbinput.container div.input_area, div.nboutput.container div.output_area { width: 100%; } } /* input area */ div.nbinput.container div.input_area { border: 1px solid #e0e0e0; border-radius: 2px; /*background: #f5f5f5;*/ } /* override MathJax center alignment in output cells */ div.nboutput.container div[class*=MathJax] { text-align: left !important; } /* override sphinx.ext.imgmath center alignment in output cells */ div.nboutput.container div.math p { text-align: left; } /* standard error */ div.nboutput.container div.output_area.stderr { background: #fdd; } /* ANSI colors */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } div.nbinput.container div.input_area div[class*=highlight] > pre, div.nboutput.container div.output_area div[class*=highlight] > pre, div.nboutput.container div.output_area div[class*=highlight].math, div.nboutput.container div.output_area.rendered_html, div.nboutput.container div.output_area > div.output_javascript, div.nboutput.container div.output_area:not(.rendered_html) > img{ padding: 5px; margin: 0; } /* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */ div.nbinput.container div.input_area > div[class^='highlight'], div.nboutput.container div.output_area > div[class^='highlight']{ overflow-y: hidden; } /* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */ .prompt .copybtn { display: none; } /* Some additional styling taken form the Jupyter notebook CSS */ .jp-RenderedHTMLCommon table, div.rendered_html table { border: none; border-collapse: collapse; border-spacing: 0; color: black; font-size: 12px; table-layout: fixed; } .jp-RenderedHTMLCommon thead, div.rendered_html thead { border-bottom: 1px solid black; vertical-align: bottom; } .jp-RenderedHTMLCommon tr, .jp-RenderedHTMLCommon th, .jp-RenderedHTMLCommon td, div.rendered_html tr, div.rendered_html th, div.rendered_html td { text-align: right; vertical-align: middle; padding: 0.5em 0.5em; line-height: normal; white-space: normal; max-width: none; border: none; } .jp-RenderedHTMLCommon th, div.rendered_html th { font-weight: bold; } .jp-RenderedHTMLCommon tbody tr:nth-child(odd), div.rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .jp-RenderedHTMLCommon tbody tr:hover, div.rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } </style> <section id=Big-Data-Strategies > <h1 id=big-data-strategies--page-root >Big Data Strategies<a class=headerlink  href="#big-data-strategies--page-root" title="Permalink to this headline">¶</a></h1> <section id="Step-1:-Do-I-Have-“Big-Data”?"> <h2 id="Step-1:-Do-I-Have-“Big-Data”?">Step 1: Do I Have “Big Data”?<a class=headerlink  href="#Step-1:-Do-I-Have-“Big-Data”?" title="Permalink to this headline">¶</a></h2> <p>Oddly, this is not actually a straightforward question for two reasons:</p> <ol class="arabic simple"> <li><p><strong>Programs often copy data to manipulate it.</strong> When you, say, sort an array, what your computer <em>actually</em> does is create a new empty array, then move over entries from your original array into the new array one entry at a time (in sorted order). While it does then erase the original array, while it’s working it effectively has two copies of your array. As a result, the fact that you have 16GB of RAM doesn’t mean you can easily work with a 14GB file. As a general rule, you need <em>at least</em> two times as much memory as your file takes up when first loaded.</p> <li><p><strong>The size of data changes as you change its format.</strong> For example, if you’re reading data from an inefficient file format (like a .csv text file), it may be the case that a file that is 10GB on disk may actually be only a few GB once you load it into a program like Python that knows how to store data more efficiently.</p> </ol> <section id="So-how-do-I-check-to-see-if-my-data-is-fitting-in-memory?"> <h3 id="So-how-do-I-check-to-see-if-my-data-is-fitting-in-memory?">So how do I check to see if my data is fitting in memory?<a class=headerlink  href="#So-how-do-I-check-to-see-if-my-data-is-fitting-in-memory?" title="Permalink to this headline">¶</a></h3> <p>If your program starts using more space than you have main memory, your operating system will usually just start using your hard drive for extra space without telling you (this is called “virtual memory”, and is nice in that it prevents your computer from crashing, though it will slow stuff down a lot). As a result, you won’t always get an error message if you try and load a file to is much bigger than main memory.</p> <p>To avoid this, use one of the tools provided by your operating system to monitor whether it’s using the hard drive:</p> <ul class=simple > <li><p><strong>OSX:</strong> OSX comes with a program called <a class="reference external" href="https://support.apple.com/en-us/HT201464#memory">Activity Monitor</a> in the Applications &gt; Utilities folder. The memory tab of Activity Monitor has a graph at the bottom called “Memory Pressure”. If this is green, you’re good. If it’s yellow or red, you’re actively going back and forth to your hard drive. (Note your computer may be using “virtual memory” without affecting performance if it’s just storing away things you aren’t actively using).</p> <li><p><strong>Windows:</strong> Windows has a program called <a class="reference external" href="http://en.wikipedia.org/wiki/Resource_Monitor">“Resource Monitor”</a> that shows data on memory use. If you get near 100% Used Physical Memory, your computer is probably using the hard drive.</p> </ul> </section> </section> <section id="Step-2:-Pick-a-Strategy"> <h2 id="Step-2:-Pick-a-Strategy">Step 2: Pick a Strategy<a class=headerlink  href="#Step-2:-Pick-a-Strategy" title="Permalink to this headline">¶</a></h2> <p>If you have big data, you basically have four options:</p> <ol class="arabic simple"> <li><p>Use chunking to trim and thin out your data so it <em>does</em> fit in memory (this works if the data you were given is huge, but the final analysis dataset you want to work with is small).</p> <li><p>Buy more memory. Seriously, consider it.</p> <li><p>Minimize the penalties of working off your hard drive (not usually practical for data science)</p> <li><p>Break your job into pieces and distribute over multiple machines.</p> </ol> <section id="Strategy-1:-Trim-till-it-fits"> <h3 id="Strategy-1:-Trim-till-it-fits">Strategy 1: Trim till it fits<a class=headerlink  href="#Strategy-1:-Trim-till-it-fits" title="Permalink to this headline">¶</a></h3> <p>At least in my experience, <em>most</em> of the time people have a dataset that’s too big to load into main memory, they’re in a situation where the <em>raw</em> data they want to work with is too big for main memory, but the dataset they are trying to create for analysis will not be. This can happen when the raw data you’re working with:</p> <ul class=simple > <li><p>has lots of variables you don’t need for your analysis,</p> <li><p>has lots of observations you don’t need for your analysis,</p> <li><p>the data is at a more granular level than you need for analysis (e.g. it’s individual level, but you only need averages for different groups), or</p> <li><p>where data is formatted in an inefficient manner where better data management would allow it to fit.</p> </ul> <p>In these situations, the go-to strategy is <strong>chunking</strong>, which is the practice of:</p> <ul class=simple > <li><p>loading only a small part of your data, preprocessing it (dropping extra variables, dropping extra observations, taking averages, and/or storing the data in more efficient formats), and saving it away,</p> <li><p>then recombining all the now substantially smaller bits into a new analysis dataset that has everything you want and fits into main memory.</p> </ul> <p>Chunking is pretty easy with most data formats. In pandas, for example, you can specify what rows you want to import using either the <code class="docutils literal notranslate"><span class=pre >nrows</span></code> (to specify you only want the first <code class="docutils literal notranslate"><span class=pre >n</span></code> rows read into memory), or you can use the combination of <code class="docutils literal notranslate"><span class=pre >skiprows</span></code> and <code class="docutils literal notranslate"><span class=pre >nrows</span></code> to get a specific set of rows (i.e. “start right after the number of rows in <code class="docutils literal notranslate"><span class=pre >skiprows</span></code>, then take <code class="docutils literal notranslate"><span class=pre >nrows</span></code> from there). Or if you really want to be fancy, you can just use <code class="docutils literal notranslate"><span class=pre >read_csv</span></code> as an iterator using <code class="docutils literal notranslate"><span class=pre >iterator=True</span></code> and <code class="docutils literal notranslate"><span class=pre >chunksize</span></code>, which will return an object that you can loop over and which pulls in the number of rows you specify in <code class="docutils literal notranslate"><span class=pre >chunksize</span></code> each pass of the loop. We’ll also discuss a tool (<code class="docutils literal notranslate"><span class=pre >dask</span></code>) that helps automate this process, though using it properly requires understanding how it works, so we won’t introduce it till later.</p> <p>Types of thinning you may wish to do during import:</p> <ul class=simple > <li><p>Drop unneeded variables</p> <li><p>Convert strings variables to numeric or categorical/factor datatypes (Strings almost always have the largest memory footprint)</p> <li><p>Drop unneeded observations</p> <li><p>Collapse observations</p> <li><p>Change numeric datatypes to more compressed formats (e.g. using <code class="docutils literal notranslate"><span class=pre >Float32</span></code> instead of <code class="docutils literal notranslate"><span class=pre >Float64</span></code> when you know you don’t need all the precision offered by <code class="docutils literal notranslate"><span class=pre >Float64</span></code>. See <a class="reference external" href=ints_and_floats.ipynb >numbers in machines</a> for a refresher on tradeoffs from different data types. **Be especially careful compressing Ints from Int64 to Int32: it’s hard to overflow Int64, but very easy to overflow Int32!).</p> </ul> <p>Finally, note that some import functions can do this automatically without you having to chunk your data manually. For example, <code class="docutils literal notranslate"><span class=pre >read_csv</span></code> has a <code class="docutils literal notranslate"><span class=pre >usecols</span></code> option (where you can specify a subset of columns you want to keep), and a <code class="docutils literal notranslate"><span class=pre >dtypes</span></code> option (for specifying the data format in which you want data stored <em>as it’s streaming in</em> from disk).</p> <p><strong>Note: Memory management in Python:</strong> If you’re chunking, you need to know about how Python manages memory.</p> <p>In general, we never think about memory management. When you create an object, Python allocates it memory, and when no one is using an object anymore, or when your code finishes running, Python throws it away. Great.</p> <p>But when you’re pushing the limits of your computer, it’s sometimes important to intervene to encourage Python to delete things sooner than it might otherwise.</p> <p>In general, Python will only remove something from memory <em>when there is no longer any way for the programmer to access that data</em>. So for example, if you ran the code:</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[1]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >x</span> <span class=o >=</span> <span class=p >[</span><span class=mi >1</span><span class=p >,</span> <span class=mi >2</span><span class=p >,</span> <span class=mi >3</span><span class=p >]</span>
<span class=n >x</span> <span class=o >=</span> <span class=s1 >'hello!'</span>
</pre></div> </div> </div> <p>In line 1, Python would create your list in memory. Then in line 2, it would delete that list since the only way you previously had to access that list (the variable <code class="docutils literal notranslate"><span class=pre >x</span></code>) has been reassigned, leaving you incapable of getting to the list.</p> <p>Why does this matter to you? Because if you have a big thing that you’re done with, and you want to delete it, the only way to do it is to reassign all the variables that previously pointed to it to something else (by convention, you often reassign them to <code class="docutils literal notranslate"><span class=pre >None</span></code>), or you use the <code class="docutils literal notranslate"><span class=pre >del</span></code> command:</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[2]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >x</span> <span class=o >=</span> <span class=p >[</span><span class=mi >1</span><span class=p >,</span> <span class=mi >2</span><span class=p >,</span> <span class=mi >3</span><span class=p >]</span>
<span class=k >del</span> <span class=n >x</span>
</pre></div> </div> </div> <p>Just remember that <code class="docutils literal notranslate"><span class=pre >del</span></code> removes the <em>variable</em>, not the object. The object will only disappear if <em>nothing</em> points to it. So in this situation:</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[3]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >x</span> <span class=o >=</span> <span class=p >[</span><span class=mi >1</span><span class=p >,</span> <span class=mi >2</span><span class=p >,</span> <span class=mi >3</span><span class=p >]</span>
<span class=n >y</span> <span class=o >=</span> <span class=n >x</span>
<span class=k >del</span> <span class=n >x</span>
</pre></div> </div> </div> <p>Python won’t delete the list because while you deleted <code class="docutils literal notranslate"><span class=pre >x</span></code>, the list is still accessible via <code class="docutils literal notranslate"><span class=pre >y</span></code>!</p> </section> <section id="Strategy-2:-Pay-for-More-Memory"> <h3 id="Strategy-2:-Pay-for-More-Memory">Strategy 2: Pay for More Memory<a class=headerlink  href="#Strategy-2:-Pay-for-More-Memory" title="Permalink to this headline">¶</a></h3> <p>Don’t overlook this option: buying RAM doesn’t cost a fortune (especially for desktops), and renting a single big virtual machine on the cloud can be similarly cost-effective.</p> <p>For example, you can get 100GB of RAM new for about $300 (and this will only go down over time), which means you can easily buy a desktop PC with all the ram and processing power you want for well under a thousand dollars. That’s not a small amount of money, but <em>your</em> time as a data scientist is also valuable (both to you and to whoever is paying you), and if you can obviate having to deal with all these kinds of problems by just buying a bigger computer (especially if it helps you avoid the strategies described below), it can be an incredibly good investment.</p> <p>And you can rent a Virtual Machine with hundreds of GB of RAM for a couple bucks an hour, something <a class="reference external" href=cloud_what_is_it.ipynb >we’ll discuss in a later lesson</a>.</p> </section> <section id="Strategy-3:-Minimize-disk-access-penalties."> <h3 id="Strategy-3:-Minimize-disk-access-penalties.">Strategy 3: Minimize disk-access penalties.<a class=headerlink  href="#Strategy-3:-Minimize-disk-access-penalties." title="Permalink to this headline">¶</a></h3> <p>There are a number of tools designed to minimize the penalties associated with moving data off-disk. <code class="docutils literal notranslate"><span class=pre >HDF5</span></code>, for example, is a file format that does things like:</p> <ul class=simple > <li><p>compresses data (it’s actually faster to move a small amount of compressed data from the hard drive to main memory and then decompress it than it is to move a large amount of uncompressed memory off-disk. That’s how big the penalty is to read data off disk).</p> <li><p>can give you select rows or select columns from a dataset without loading the whole thing into memory first</p> <li><p>stores data in efficient memory formats.</p> </ul> <p>SQL, similarly, is designed to maximize the efficiency by which data can be pulled from disk, but in general, if you aren’t in a situation where (a) lots of people are gonna be accessing the same data <em>at the same time</em>, or (b) you don’t plan to do tons of different analyses using the same dataset over a long period, the upfront costs of setting up a SQL database overwhelm the benefits it has at the time you want to run a query.</p> <p>But it’s also worth emphasizing that the strategies described above are generally only efficient if your goal is to pull a <em>subset</em> of data from disk. This makes them useful for things like medical databases, where doctors want to be able to quickly pull the records of individual patients. But in data science, we <em>usually</em> want to load a lot of data at once, so the ability to quickly pull subsets of data isn’t always super useful.</p> </section> <section id="Strategy-4:-Distributed-Computing"> <h3 id="Strategy-4:-Distributed-Computing">Strategy 4: Distributed Computing<a class=headerlink  href="#Strategy-4:-Distributed-Computing" title="Permalink to this headline">¶</a></h3> <p><strong>If absolutely everything else has failed</strong> it’s time to turn to distributed computing!</p> <p>Distributed computing (using lots of individual computers working in concert in a “cluster”) is the practice of taking your task and your data, breaking it into smaller pieces, sending those pieces to different computers, running the “smaller pieces” on those different computers, then bringing back the results and recombining them into a single output.</p> <p>Distributed computing is amazing, and makes possible many things that would never be possible otherwise. But it is not without two very important substantial costs:</p> <ul class=simple > <li><p>Programmer time: it takes a lot of time to learn to use these systems, to set up these systems, and to find a way to take code that works easily on one computer and parallelize it and distribute it across lots of computers. <strong>Note that not all jobs can be parallelized!</strong> See <a class="reference internal" href=parallelism.html ><span class=doc >parallelism</span></a>.</p> <li><p>Computer time: there is a <em>huge</em> fixed cost to break up jobs, move those jobs between computers, and recombine the results. As a result, if a job <em>can</em> be done on one computer, it will <em>usually</em> run faster on one computer than distributed across lots of computers.</p> </ul> <p>For these reasons, you should <em>only</em> use distributed computing if the following apply:</p> <ul class=simple > <li><p>Your job is highly parallelizable so you <em>can</em> distribute the job across lots of computers.</p> <li><p>You <em>can’t</em> do the job on one computer either because there isn’t enough space in memory, or because your job is parallelizable <em>and</em> you need far more processors than you can get on one computer to run the job in a reasonable period of time.</p> <ul> <li><p>One obvious case for this is a situation where your data doesn’t even fit on the hard drives of one computer. This is a real problem for companies like Google and Facebook, and is actually one of the main reasons that distributed computing exists.</p> </ul> </ul> <p>So if you’re in this domain, what options are open to you?</p> <p>The Cloud! There are a few platforms for managing a distributed cluster of computers, including things you may have heard of like <a class="reference external" href="https://en.wikipedia.org/wiki/Apache_Hadoop">Apache Hadoop</a> or <a class="reference external" href="https://en.wikipedia.org/wiki/Apache_Spark">Apache Spark</a>, which you can kind of think of as Hadoop v2.0.</p> <p>In this class, though, we’ll primarily focus on how to use a program called <code class="docutils literal notranslate"><span class=pre >dask</span></code>, which has the same syntax as <code class="docutils literal notranslate"><span class=pre >pandas</span></code>, but works like Spark. We’ll cover <code class="docutils literal notranslate"><span class=pre >dask</span></code> <a class="reference internal" href=distributed_computing.html ><span class=doc >in a later class</span></a>, then also learn to setup a <code class="docutils literal notranslate"><span class=pre >dask</span></code> cluster on the <a class="reference external" href=cloud_azureml.ipynb >Microsoft Azure system too</a>!</p> </section> </section> <section id="Exercises!"> <h2 id="Exercises!">Exercises!<a class=headerlink  href="#Exercises!" title="Permalink to this headline">¶</a></h2> <p>Great! Now that you have some context for big data, let’s do some exercises.</p> <p><a class="reference external" href="exercises/exercise_bigdata.ipynb">Exercises</a></p> </section> </section> </article> </div> </div> </main> </div> <footer class=md-footer > <div class=md-footer-nav > <nav class="md-footer-nav__inner md-grid"> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright > <div class=md-footer-copyright__highlight > &#169; Copyright 2021, Nick Eubank. </div> Created using <a href="http://www.sphinx-doc.org/">Sphinx</a> 4.5.0. and <a href="https://github.com/bashtage/sphinx-material/">Material for Sphinx</a> </div> </div> </div> </footer> <script src="_static/javascripts/application.js"></script> <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>